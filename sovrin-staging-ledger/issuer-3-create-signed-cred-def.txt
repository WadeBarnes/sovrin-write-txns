# Run this script after creating and writing schema
# =======================================
# WWJB - Do we even need to connect to the pool for these operations?
# =======================================
pool connect sandbox
load-plugin library=libindystrgpostgres.so initializer=postgresstorage_init
wallet open local_wallet key storage_credentials={"account":"DB_USER","password":"DB_PASSWORD","admin_account":"postgres","admin_password":"mysecretpassword"}
# manually enter key
did use VePGZfzvcgmT3GTdYgpDiT
# by default use our local author DID
# for the following we need the proper schema_id and primary key from the ledger/wallet
ledger cred-def  sign=true endorser=DFuDqCYpeDNXLuc3MKooX3 schema_id=10 signature_type=CL tag=tag primary={"n":"105654088397769362555510262241739436486415751242956944049070886614901976278463682562579042928415785036795845126361745853724046636929768620223046215520036622553019947787895465310398016673838505448727075239843262791696015008441964841762125042388227764089281053288441740538852396668070257667923003946383960361719909844749911376603883331980760981471662584742753546064593816556558850689578818230837329332848073200478400526771038049114518305805563119487067096514159080964276328033402801612973529592961564745657380212160573414623508029937623853844018548244503193935645955339556157903396680514521919854112067206547535994814369","rctxt":"64675721856053547451245330336555947308145884948812880663783364894605748628544783520625160331774403069131430696578783743504712836713931443392963421706054542139182668743797720238822477278615616181826029088335704914757239167421790874289051267913146649909463331721570876294986535588467378466865906107824024586071302499055992243494059671337615369578485749833180612354397725212339130445253819592374135696216099838857208094407624462542163457522456115250100881852998748146137019013551125022925257172753823368569858734904209344293348070412814737551953811279206981310684682057724553720610736548437011241589872138120644205182190","s":"70489607008577684414727143820377385370338806963102242340198592753623925724673010432190639094140563811987705521077321118121441095944165839892945455805772757147817336156831562563499684256940659124976553501966045265687520519859619126830286896986690855666504976327260186658423317628973482088311614853383106628477600797459811996133755438618193673030742497690627294726647951418399962699318279543052503944687559013392418297459998630710728443253119309704878015143096598836810619996111562076309160907841865082152099714444625255936991199582268931072529355154327292635551165773286330594792249012026715769201557284345505828894183","r":{"permit_status":"78172010735130923627929468453351989920460863924599456295782150239823834594982725560265989850657851224351533234549439393481585066994863219585707868199735526181272048461395369763453951691256698361683358872731151465747270923898038922504119209777116630120292672774410509238860111365445846936071391999426189356814573308018886128469344779624439059728254718616774700466623006912108275111501734851130751672137759200946173599333370707809654456108911569882689868111422134096009376522471705447609850922029544837743567303823673231882333529796912120142064458168755788530722786624192089314129657391925986609250867938096842343322028","corp_num":"46309284493537636821415420931155510078412501962991731681153618498106083767244214175851935343834617414268894017474719410252941166815972968953015569340804270319480487126743902889392978955809099750561585863337666103794546082583745880648559166861450103605308894474470943587972856422661674086253750374573057552672113301920751274209787339210979779386394315830963777365161719377904103327788570637797653759103513142852739001650705548392335336321185432166051150866375423175950234909374396147371725701705411311682605327793382923936400494880997002677355986301845216220539792837291923649924539776554728776404662610316884462127085","permit_id":"7119217824416555040678858494458987970340840048482815031525771776652961055529395963502244317023753451197677386371454942689637693031699588589492253095040063940918587537634557896377771010092542301444980679141410042744242399166196201387072432940515060390816606515476296128049958381763647794874890868884946356083487467357082493425468426675702355772041555973019938393116585494021084345141808961731855935301837491964962522429262513237254872927443027184645299495362128883620904457516986567506566146405041377066178815030504228237336954673535026796263597533203267935499905704739357201477250216118749953236979794144719056885247","permit_issued_date":"31756738755104084142771883266602052161993149950570516694496607348312203362332445775624095254185090266531981005418568320863635388204802760695501259208675931345706055928429166087977327550930521195217350168197640040557776691462938121848846397862882052533341981870882139294698897847819412616280123479528698251499179023560254696241323997612465415344132481885844129268434338497671543887940374451937684404525665521325565009610621013473394345331063087645001937772506716704688759405357533056995936636920536349852569282003202008152934393729715055566606210339381305616297135062491760228249741821091562954136110107842481872112420","effective_date":"453867314953055158970600694729203337896620432996634846143451139312276984073088979186465774354574804507860588505979403065600193378466194449432706187725391642178463643367830066045749124352614238015278365557342177835987155830475010564359908120109774983467110402840792109659043367829861364980670542716988260961625699426583748013766146786018332162139563286386179010599314456021283902571607501851974281413256798867445588625989595853791890747558790788016452495877703419328911185025239267355299017248815420998239418934243173770007548526047288103155353470312471371400710931699460293395237178810446329713578454111796867383211","master_secret":"61121024470358831499822010086697809290281435884771934764349697090132956007339887501443152219688206496899804287620031442793596421600950752049566975336758889828169775385254382361430596788384589985313720458142714306495808059741551529066995482844082980891959168169282501001525628363879753473969051053233210463014743820106250640918219769729576843519540682772529806677591066568833426412467711674229286653083411230074368204847805705713138857181017102659125043934035979418601927525257459818628750179772990819057330475333532285817499835535594560903024060687081247860668786008239968976918965900481795508541892897404489476514036","permit_type":"2953476445953212462988253082069260365315352808427206832854419887787604122860288294413562267695808417539852583017773725434069453605211500544556583175519480660066570964098444081153488803687347262700261433969312666834786085844729710550346465736255717022752574469453018951944533772784542690970596158543812935292972490004339799459743473255221976705366078569697574939777657396544591742996962994529229046238588166984148506018185708358172275777219577033125702067819789259258687442115371544223702715709139077505110942439084453668604435887366557191419060208173853106209645265686253734372272416603553500232301735841985783844329","legal_name":"102337174514907588342345671694379645590950015226913772929318768064445183036985389340907566049888086728431288325981715195122917501783765507102147547887041306492535068640430792502394915168792515467462222647981543408011862747975603201422648564344164752072728061927184838251990172261704759756808403491146995598955933537578163693642827235177391045556165711413357932862345695771985289408061011539262526493360163212598306778064052124542044127675233619928026149203803849088096661966484825250676530902118536748880291513264321548606258758304505487403278539272140153506665216988242687116325234770957673639319150539008545190803469"},"z":"50879459843740545714592803279690705693374829323193965301491762475053279618369938563523822521174119786465046135156867728802866330830426592309102687454772980281267352744359517283476230103009670188094913146495803546286926943481218363010939500690389380106695277941371475541796397998440753970822019778894882370006052960096252651056797395220435049952596924276106015808405081231051022921484354952572442835881586429564524885122883189412856291258864719432890099146926215885190541211229546985061682990685957864744445667673103173139799183997454172499216739672039027307816343187984123189740839174989903826421363987667360851713236"}
# transaction gets signed
ledger save-transaction file=/tmp/dev_cred_def_signed.txt
# response "y" to save the transaction
# manually edit the file to add ,"endorser":"DFuDqCYpeDNXLuc3MKooX3"
exit